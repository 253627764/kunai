var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(a,s){function r(t){try{h(n.next(t))}catch(e){s(e)}}function o(t){try{h(n["throw"](t))}catch(e){s(e)}}function h(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(r,o)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(a)throw new TypeError("Generator is already executing.");for(;h;)try{if(a=1,s&&(r=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(s,i[1])).done)return r;switch(s=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,s=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(r=h.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){h.label=i[1];break}if(6===i[0]&&h.label<r[1]){h.label=r[1],r=i;break}if(r&&h.label<r[2]){h.label=r[2],h.ops.push(i);break}r[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],s=0}finally{a=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,s,r,o,h={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},GamePlayingPanel=function(t){function e(){var e=t.call(this)||this;return e.rotations=3,e.isShooting=!1,e.insertRotate=[],e.kunaiW=21,e.kunaiH=100,e.rate=35,e.kunaiNum=9,e.level=1,e.calcCollision=function(t){var i=e.insertRotate;return i.some(function(e){return t<=e.range[1]&&t>=e.range[0]})},e.initGame(),e}return __extends(e,t),e.prototype.start=function(){this.startAnimation()},e.prototype.end=function(){this.resetGame()},e.prototype.initGame=function(){var t=egret.MainContext.instance.stage,e=t.stageWidth,i=t.stageHeight;this.bgimg=new egret.Bitmap,this.bgimg.texture=RES.getRes("4_jpg"),this.bgimg.x=0,this.bgimg.y=0,this.bgimg.width=e,this.bgimg.height=i,this.bgimg.alpha=.4,this.addChild(this.bgimg),this.timber=this.createBitmapByName("timber_png"),this.addChild(this.timber),this.timber.width=200,this.timber.height=200,this.timber.anchorOffsetX=this.timber.width/2,this.timber.anchorOffsetY=this.timber.height/2,this.timber.x=e/2,this.timber.y=230,this.layerNum=this.numChildren,this.createText(),this.createKunai(),this.createKunaiNum(),this.createScores(),this.share()},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(){var t=this;this.timberInterval&&clearInterval(this.timberInterval),this.timber.rotation=0,this.timberInterval=setInterval(function(){t.timber.rotation+=t.rotations},this.rate)},e.prototype.shoot=function(t){var e=this;if(!(this.isShooting||this.kunaiNum<=0)){this.isShooting=!0,this.kunaiNum-=1,this.updateKunaiNum();var i=function(){if(e.calcCollision(e.timber.rotation))e.flickKunai();else{e.woodBits();var t=e.timber.x,i=e.timber.y;egret.Tween.get(e.timber).to({x:e.timber.x-6,y:e.timber.y-7},20,egret.Ease.bounceInOut).to({x:t,y:i},20,egret.Ease.bounceInOut),e.createRotateKunai(),e.updateScores(),e.kunaiNum<=0&&e.showNext()}};egret.Tween.get(this.kunai).to({y:380},150,egret.Ease.cubicIn).call(i,this)}},e.prototype.createClickable=function(){var t=egret.MainContext.instance.stage,e=new egret.Shape;e.graphics.beginFill(0,0),e.graphics.drawRect(0,t.stageHeight-200,t.stageWidth,300),e.graphics.endFill(),this.addChild(e),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shoot,this)},e.prototype.createKunai=function(){var t=egret.MainContext.instance.stage;this.kunai=this.createBitmapByName("kunai_png"),this.addChild(this.kunai);var e=t.stageWidth,i=t.stageHeight;this.kunai.width=this.kunaiW,this.kunai.height=this.kunaiH,this.kunai.x=e/2-10,this.kunai.y=i-170,this.createRandomKunai(),this.createClickable()},e.prototype.resetKunai=function(){var t=egret.MainContext.instance.stage,e=t.stageWidth,i=t.stageHeight;this.kunai.width=20,this.kunai.height=100,this.kunai.rotation=0,this.kunai.x=e/2-10,this.kunai.y=i-170,this.isShooting=!1},e.prototype.createRotateKunai=function(t){var e=this,i=egret.MainContext.instance.stage,n=t?-1*t:this.timber.rotation,a=[];a.push(n-10),a.push(n+10);var s=this.createBitmapByName("kunai_png");s.anchorOffsetX=5,s.anchorOffsetY=-52,s.x=i.stageWidth/2,s.y=230,s.width=this.kunaiW,s.height=this.kunaiH,s.rotation=t?t:0,this.addChildAt(s,this.layerNum-1),setInterval(function(){s.rotation+=e.rotations},this.rate);var r={id:n,range:a,kunai:s};this.insertRotate.push(r),this.resetKunai()},e.prototype.removeRotateKunai=function(t){void 0===t&&(t=3);for(var e=function(t){var e=i.insertRotate.splice(0,1)[0];e&&e.kunai&&egret.Tween.get(e.kunai).to({alpha:0},100).call(function(){e.kunai.parent.removeChild(e.kunai)},i)},i=this,n=0;t>n;n++)e(n)},e.prototype.flickKunai=function(){var t=this,e=egret.MainContext.instance.stage,i=function(){setTimeout(function(){t.showDialog()},500)};egret.Tween.get(this.kunai).to({x:e.stageWidth+100,y:e.stageHeight+100,rotation:720},700,egret.Ease.bounceOut).call(i,this)},e.prototype.createText=function(){var t=(egret.MainContext.instance.stage,new egret.Shape);t.graphics.beginFill(3086352,.8),t.graphics.drawRoundRect(-10,10,80,30,10),t.graphics.endFill(),this.addChild(t),this.textfield=new egret.TextField,this.addChild(this.textfield),this.textfield.x=12,this.textfield.y=17,this.textfield.textColor=16777215,this.textfield.textAlign=egret.HorizontalAlign.CENTER,this.textfield.size=14,this.updateLevel()},e.prototype.updateLevel=function(){this.textfield.text="第 "+this.level+" 关"},e.prototype.createKunaiNum=function(){var t=egret.MainContext.instance.stage,e=this.createBitmapByName("kunai_png");e.width=10,e.height=50,e.x=30,e.y=t.stageHeight-100,this.addChild(e),this.kunaiNumTips=new egret.TextField,this.addChild(this.kunaiNumTips),this.kunaiNumTips.x=50,this.kunaiNumTips.y=t.stageHeight-80,this.kunaiNumTips.textColor=16777215,this.kunaiNumTips.textAlign=egret.HorizontalAlign.LEFT,this.kunaiNumTips.size=14,this.updateKunaiNum()},e.prototype.updateKunaiNum=function(){this.kunaiNumTips.text="x "+this.kunaiNum},e.prototype.createScores=function(){var t=egret.MainContext.instance.stage,e=new egret.Shape;e.graphics.beginFill(16777215,.8),e.graphics.drawRoundRect(t.stageWidth/2-50,10,100,60,10),e.graphics.endFill(),this.addChild(e);var i=new egret.TextField;i.size=18,i.textColor=0,i.text="得分",i.x=t.stageWidth/2-i.width/2,i.y=20,this.addChild(i),this.scores=new egret.TextField,this.scores.size=16,this.scores.textColor=0,this.scores.text="0",this.scores.x=t.stageWidth/2-this.scores.width/2,this.scores.y=45,this.addChild(this.scores)},e.prototype.updateScores=function(t){var e=egret.MainContext.instance.stage;this.scores.text="number"==typeof t?""+t:""+(parseInt(this.scores.text)+1),this.scores.x=e.stageWidth/2-this.scores.width/2},e.prototype.showNext=function(){var t=this;setTimeout(function(){t.goNext()},300)},e.prototype.goNext=function(){this.level+=1,this.kunaiNum=9,this.updateKunaiNum(),this.updateLevel(),this.cleanBitmap(),this.createRandomKunai(),this.startAnimation()},e.prototype.createRandomKunai=function(){for(var t=1;t<this.level;t++){var e=Math.floor(180*Math.random());e=Math.random()<.5?-1*e:e,this.createRotateKunai(e)}},e.prototype.showDialog=function(){return __awaiter(this,void 0,void 0,function(){var t,i,n=this;return __generator(this,function(a){return t=egret.MainContext.instance.stage,this.dialog=new Dialog,this.dialog.setScores(this.scores.text),this.addChild(this.dialog),this.dialog.x=t.stageWidth/2-this.dialog._width/2,this.dialog.y=t.stageHeight/2-this.dialog._height/2,this.dialog.addEventListener(Dialog.GO_HOME,function(){n.dispatchEventWith(e.GAME_END)},this),this.dialog.addEventListener(Dialog.RESTART,function(){n.resetGame()},this),this.dialog.addEventListener(Dialog.REBIRTH,function(){n.rebirth()},this),this.dialog.addEventListener(Dialog.NOCHANCE,function(){n.noChance()},this),i={key:"score",value:this.scores.text},platform.setUserCloudStorage(i),[2]})})},e.prototype.closeDialog=function(){var t=this;this.removeChild(this.dialog),this.dialog.removeEventListener(Dialog.GO_HOME,function(){t.dispatchEventWith(e.GAME_END)},this),this.dialog.removeEventListener(Dialog.RESTART,function(){t.resetGame()},this),this.dialog.removeEventListener(Dialog.REBIRTH,function(){t.rebirth()},this)},e.prototype.resetGame=function(){this.closeDialog(),this.level=1,this.kunaiNum=9,this.updateKunaiNum(),this.updateLevel(),this.cleanBitmap(),this.resetKunai(),this.createRandomKunai(),this.updateScores(0),this.startAnimation()},e.prototype.cleanBitmap=function(){this.insertRotate.forEach(function(t){t.kunai.parent.removeChild(t.kunai)}),this.insertRotate=[]},e.prototype.woodBits=function(){for(var t=this,e=egret.MainContext.instance.stage,i=e.stageWidth,n=e.stageHeight,a=function(e){var a=s.createBitmapByName("dou_png");a.width=5,a.height=5,a.x=i/2-1,a.y=290,s.addChild(a);var r=Math.floor(Math.random()*i*2);r=Math.random()<.5?-1*r:r,egret.Tween.get(a).to({x:r,y:n},500,egret.Ease.sineOut).call(function(){t.removeChild(a)})},s=this,r=0;4>r;r++)a(r)},e.prototype.share=function(){var t=this,e=egret.MainContext.instance.stage;this.s1=this.createBitmapByName("s1_png"),this.s1.width=59,this.s1.height=53.5,this.s1.x=e.stageWidth-this.s1.width,this.s1.y=e.stageHeight-330;var i=this.s1.y;this.addChild(this.s1),egret.Tween.get(this.s1,{loop:!0}).to({y:this.s1.y+10},1e3).to({y:i},1e3),this.s1.touchEnabled=!0,this.s1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){platform.share(t.removeRotateKunai(3))},this)},e.prototype.rebirth=function(){this.closeDialog(),this.resetKunai(),this.kunaiNum+=1,this.updateKunaiNum()},e.prototype.noChance=function(){var t=new Msg;this.addChild(t),t.init("一天只有三次复活机会哦")},e.GAME_END="gameend",e.GAME_RESTART="gamerestart",e}(egret.Sprite);__reflect(GamePlayingPanel.prototype,"GamePlayingPanel");var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),platform.openDataContext.postMessage({command:"loadRes"}),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return i.sent(),this.stage.removeChild(t),[3,5];case 4:return e=i.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){var t=this.stage,e=new egret.Shape;e.graphics.beginGradientFill(egret.GradientType.RADIAL,[16178084,16576726],[1,1],[150,50],new egret.Matrix),e.graphics.drawRect(0,0,t.stageWidth,t.stageHeight),e.graphics.endFill(),this.addChild(e),this.init()},e.prototype.init=function(){this.gameStartPanel=new GameStartPanel,this.gamePlayingPanel=new GamePlayingPanel,this.gameEndPanel=new GameEndPanel,this.start()},e.prototype.start=function(){this.addChild(this.gameStartPanel),this.gameStartPanel.start(),this.gameStartPanel.addEventListener(GameStartPanel.GAME_START,this.gamePlaying,this)},e.prototype.gamePlaying=function(){this.gameStartPanel.end(),this.removeChild(this.gameStartPanel),this.gameStartPanel.removeEventListener(GameStartPanel.GAME_START,this.gamePlaying,this),this.addChild(this.gamePlayingPanel),this.gamePlayingPanel.start(),this.gamePlayingPanel.addEventListener(GamePlayingPanel.GAME_END,this.gameEnd,this),this.gamePlayingPanel.addEventListener(GamePlayingPanel.GAME_RESTART,this.gameRestart,this)},e.prototype.gameEnd=function(){this.gamePlayingPanel.end(),this.removeChild(this.gamePlayingPanel),this.gamePlayingPanel.removeEventListener(GamePlayingPanel.GAME_END,this.gameEnd,this),this.gamePlayingPanel.removeEventListener(GamePlayingPanel.GAME_RESTART,this.gameRestart,this),this.start()},e.prototype.gameRestart=function(){},e}(eui.UILayer);__reflect(Main.prototype,"Main");var Buttons=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t,e,i,n,a){var s=this;void 0===t&&(t=1),void 0===i&&(i=24),void 0===n&&(n=180),void 0===a&&(a=64),this.img=new egret.Bitmap,this.txt=new egret.TextField,this.width=n,this.height=a,1===t?(this.img.texture=RES.getRes("btn_bg_green_png"),this.txt.strokeColor=4367877):2===t?(this.img.texture=RES.getRes("btn_bg_blue_png"),this.txt.strokeColor=2458307):3===t?(this.img.texture=RES.getRes("btn_bg_purple_png"),this.txt.strokeColor=8458165):4===t?(this.img.texture=RES.getRes("btn_bg_pink_png"),this.txt.strokeColor=12781621):5===t?(this.img.texture=RES.getRes("btn_bg_brown_png"),this.txt.strokeColor=9324838):(this.img.texture=RES.getRes("btn_bg_grey_png"),this.txt.strokeColor=6645093),this.img.scale9Grid=new egret.Rectangle(10,10,14,103),this.img.width=n,this.img.height=a,this.addChild(this.img),this.txt.size=i,this.txt.textColor=16777215,this.txt.text=e,this.txt.stroke=1,this.txt.x=this.img.width/2-this.txt.width/2,this.txt.y=this.img.height/2-this.txt.height/2,this.addChild(this.txt),this.img.touchEnabled=!0,this.img.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){s.img.x=s.img.x+2,s.img.y=s.img.y+2,s.txt.x=s.txt.x+2,s.txt.y=s.txt.y+2},this),this.img.addEventListener(egret.TouchEvent.TOUCH_END,function(){s.img.x=s.img.x-2,s.img.y=s.img.y-2,s.txt.x=s.txt.x-2,s.txt.y=s.txt.y-2},this),this.img.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){s.img.x=s.img.x-2,s.img.y=s.img.y-2,s.txt.x=s.txt.x-2,s.txt.y=s.txt.y-2},this)},e}(egret.Sprite);__reflect(Buttons.prototype,"Buttons");var Dialog=function(t){function e(){var e=t.call(this)||this;return e._width=280,e._height=400,e.GAME_RESTART="gamerestart",e.GAME_SHARE="gameshare",e.GAME_AD="gamead",e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this,i=this,n=i.maskBlack,a=i.tip,s=i.homeBtn,r=i.restartBtn,o=i.shareBtn,h=i.adBtn;n=new egret.Shape,n.graphics.beginFill(0,.8),n.graphics.drawRoundRect(0,0,this._width,this._height,10),this.addChild(n),a=new egret.TextField,a.y=15,a.text="本次得分",a.textColor=16777215,a.size=18,a.x=this._width/2-a.width/2,this.addChild(a),s=new Buttons,s.init(3,"回到首页"),s.scaleX=.5,s.scaleY=.5,this.addChild(s),s.x=30,s.y=300,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEventWith(e.GO_HOME)},this),r=new Buttons,r.init(1,"再玩一次"),this.addChild(r),r.x=160,r.y=300,r.scaleX=.5,r.scaleY=.5,r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEventWith(e.RESTART)},this),o=new Buttons,o.init(2,"炫耀战绩"),this.addChild(o),o.x=30,o.y=350,o.scaleX=.5,o.scaleY=.5,o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){platform.share()},this),h=new Buttons,h.init(4,"免费复活"),this.addChild(h),h.x=160,h.y=350,h.scaleX=.5,h.scaleY=.5,h.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var i=new Date,n=""+i.getFullYear()+i.getMonth()+i.getDate(),a=t;platform.getData(n,function(t){if(t&&t.data){if(t.data){var i=t.data;i+=1,3>=i?(a.dispatchEventWith(e.REBIRTH),platform.setData({key:n,value:i})):a.dispatchEventWith(e.NOCHANCE)}}else a.dispatchEventWith(e.REBIRTH),platform.setData({key:n,value:1})})},this),this.scores=new egret.TextField,this.scores.text="0",this.scores.textAlign=egret.HorizontalAlign.CENTER,this.scores.size=22,this.scores.textColor=16777215,this.scores.y=40,this.scores.x=this._width/2-this.scores.width/2,this.addChild(this.scores)},e.prototype.setScores=function(t){this.scores.text=""+t,this.scores.x=this._width/2-this.scores.width/2},e.GO_HOME="gohome",e.RESTART="restart",e.SHARE_WX="sharewx",e.VIEW_AD="viewad",e.REBIRTH="rebirth",e.NOCHANCE="nochance",e}(egret.Sprite);__reflect(Dialog.prototype,"Dialog");var Msg=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t){var e=this,i=egret.MainContext.instance.stage,n=new egret.Shape;n.graphics.beginFill(0,.6),n.graphics.drawRect(0,-100,i.stageWidth,100),n.graphics.endFill(),this.addChild(n),egret.Tween.get(n).to({y:100},100,egret.Ease.bounceOut).call(function(){setTimeout(function(){e.removeChild(n)},3e3)},this);var a=new egret.TextField;a.size=14,a.textColor=16777215,a.text=t,a.x=i.stageWidth/2-a.width/2,a.y=-50-a.height/2,this.addChild(a),egret.Tween.get(a).to({y:50-a.height/2},100,egret.Ease.bounceOut).call(function(){setTimeout(function(){e.removeChild(a)},3e3)},this)},e}(egret.Sprite);__reflect(Msg.prototype,"Msg");var GameEndPanel=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.start=function(){var t=this,e=t.restartBtn,i=t.onTouchTap;e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,i,this)},e.prototype.init=function(){this.restartBtn=new egret.TextField,this.restartBtn.text="重新开始",this.restartBtn.x=225-this.restartBtn.width,this.restartBtn.y=400,this.addChild(this.restartBtn)},e.prototype.onTouchTap=function(){this.dispatchEventWith(e.GAME_RESTART)},e.prototype.end=function(){var t=this,e=t.restartBtn,i=t.onTouchTap;e.$touchEnabled=!1,e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,i,this)},e.GAME_RESTART="gamerestart",e}(egret.Sprite);__reflect(GameEndPanel.prototype,"GameEndPanel");var Bottom=function(t){function e(){var e=t.call(this)||this;return e.height=100,e._width=1e3,e}return __extends(e,t),e.prototype.init=function(){var t=this,i=new egret.Shape;i.graphics.beginFill(0,.5),i.graphics.drawRect(0,0,this._width,this.height),i.graphics.endFill(),this.bg=i,this.addChild(this.bg);var n=new egret.Bitmap;n.texture=RES.getRes("b1_png"),n.width=26.5,n.height=26,n.x=30,n.y=20,this.addChild(n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEventWith(e.FRIENDS_RANK)},this);var a=new egret.TextField;a.text="好友排行",a.size=12,a.textColor=16777215,a.x=20,a.y=60,this.addChild(a),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.dispatchEventWith(e.FRIENDS_RANK)},this);var s=new egret.Bitmap;s.texture=RES.getRes("b2_png"),s.width=23.5,s.height=23,s.x=130,s.y=20,this.addChild(s);var r=new egret.TextField;r.text="群内排行",r.size=12,r.textColor=16777215,r.x=120,r.y=60,this.addChild(r);var o=new egret.Bitmap;o.texture=RES.getRes("b3_png"),o.width=25.5,o.height=25.5,o.x=230,o.y=20,this.addChild(o);var h=new egret.TextField;h.text="世界排行",h.size=12,h.textColor=16777215,h.x=220,h.y=60,this.addChild(h);var g=new egret.Bitmap;g.texture=RES.getRes("b4_png"),g.width=30,g.height=29,g.x=330,g.y=20,this.addChild(g);var u=new egret.TextField;u.text="皮肤",u.size=12,u.textColor=16777215,u.x=333,u.y=60,this.addChild(u)},e.FRIENDS_RANK="friendsrank",e.GROUP_RANK="grouprank",e.WORLD_RANK="worldrank",e.SKIN="skin",e}(egret.Sprite);__reflect(Bottom.prototype,"Bottom");var GameStartPanel=function(t){function e(){var e=t.call(this)||this;return e.isdisplay=!1,e.init(),e}return __extends(e,t),e.prototype.start=function(){var t=this,e=t.stage,i=t.startBtn,n=t.onTouchTap,a=t.startPK,s=t.img,r=t.logo,o=(t.PK,t.bottom);s.width=e.stageWidth,s.height=e.stageHeight,r.x=e.stageWidth/2-r.width/2,r.y=-r.height,egret.Tween.get(r).to({y:60},500,egret.Ease.bounceOut),i.x=-i.width,i.y=400,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,n,this),egret.Tween.get(i).to({x:e.stageWidth/2-i.width/2},500,egret.Ease.bounceOut),a.x=e.stageWidth,a.y=500,a.addEventListener(egret.TouchEvent.TOUCH_TAP,n,this),egret.Tween.get(a).to({x:e.stageWidth/2-a.width/2},500,egret.Ease.bounceOut),o.y=e.stageHeight,egret.Tween.get(o).to({y:e.stageHeight-o.height},500,egret.Ease.bounceOut)},e.prototype.init=function(){var t=new egret.Bitmap;t.texture=RES.getRes("1_jpg"),t.x=0,t.y=0,t.alpha=.6,this.img=t,this.addChildAt(this.img,0);var e=new egret.Bitmap;e.texture=RES.getRes("logo_png"),e.width=751*.4,e.height=599*.4,this.logo=e,this.addChild(this.logo),this.startBtn=new Buttons,this.addChild(this.startBtn),this.startBtn.init(1,"单人闯关"),this.startPK=new Buttons,this.addChild(this.startPK),this.startPK.init(4,"疯狂模式"),this.bottom=new Bottom,this.addChild(this.bottom),this.bottom.init(),this.bottom.addEventListener(Bottom.FRIENDS_RANK,this.friendsRank,this)},e.prototype.onTouchTap=function(){this.dispatchEventWith(e.GAME_START)},e.prototype.end=function(){var t=this,e=t.startBtn,i=t.onTouchTap;e.$touchEnabled=!1,e.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,i,this)},e.prototype.friendsRank=function(){console.log(1111);var t=window.platform;this.isdisplay?(this.bitmap.parent&&this.bitmap.parent.removeChild(this.bitmap),this.rankingListMask.parent&&this.rankingListMask.parent.removeChild(this.rankingListMask),this.isdisplay=!1,t.openDataContext.postMessage({isDisplay:this.isdisplay,text:"hello",year:(new Date).getFullYear(),command:"close"})):(this.rankingListMask=new egret.Shape,this.rankingListMask.graphics.beginFill(0,1),this.rankingListMask.graphics.drawRect(0,0,this.stage.width,this.stage.height),this.rankingListMask.graphics.endFill(),this.rankingListMask.alpha=.5,this.rankingListMask.touchEnabled=!0,this.addChild(this.rankingListMask),this.bitmap=t.openDataContext.createDisplayObject(null,this.stage.stageWidth,this.stage.stageHeight),this.addChild(this.bitmap),t.openDataContext.postMessage({isDisplay:this.isdisplay,text:"hello",year:(new Date).getFullYear(),command:"open"}),this.isdisplay=!0)},e.GAME_START="gamestart",e}(egret.Sprite);__reflect(GameStartPanel.prototype,"GameStartPanel");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?n(a):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.setUserCloudStorage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.share=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,t&&t()]})})},t.prototype.setData=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,e&&e()]})})},t.prototype.getData=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,e&&e()]})})},t.prototype.removeData=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,e&&e()]})})},t.prototype.clearData=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,t&&t()]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function a(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}var r=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},r)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var o=t.split("/");o.pop();var h=o.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(h,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},r)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]),window.Main=Main;